{"version":3,"sources":["../../src/metadata/EmbeddedMetadata.ts"],"names":[],"mappings":";;AAKA;;GAEG;AACH;IAwDI,wEAAwE;IACxE,cAAc;IACd,wEAAwE;IAExE,0BAAY,KAAoB,EACpB,OAAyB,EACzB,SAA6B,EAC7B,IAA0B;QAHtC,iBAiBC;QAbG,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,EAAE,GAAG,SAAS,CAAC;QAChD,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC;QACtC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;QAC5B,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,MAAM,CAAC;QAChC,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;QAC3B,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,QAAQ;YAC3B,QAAQ,CAAC,sBAAsB,GAAG,KAAI,CAAC;QAC3C,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,UAAA,MAAM;YACvB,MAAM,CAAC,gBAAgB,GAAG,KAAI,CAAC;QACnC,CAAC,CAAC,CAAC;IACP,CAAC;IAED,wEAAwE;IACxE,iBAAiB;IACjB,wEAAwE;IAExE;;OAEG;IACH,iCAAM,GAAN;QACI,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC;YACX,MAAM,IAAI,KAAK,CAAC,iEAAiE,CAAC,CAAC;QAEvF,MAAM,CAAC,IAAK,IAAI,CAAC,IAAY,CAAC;IAClC,CAAC;IAQD,sBAAI,oCAAM;QANV;;;;;WAKG;aACH;YACI,EAAE,CAAC,CAAC,IAAI,CAAC,YAAY,KAAK,SAAS,CAAC;gBAChC,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC;YAE7B,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC;QAC7B,CAAC;;;OAAA;IAEL,uBAAC;AAAD,CA1GA,AA0GC,IAAA;AA1GY,4CAAgB","file":"EmbeddedMetadata.js","sourcesContent":["import {EntityMetadata} from \"./EntityMetadata\";\nimport {TableMetadata} from \"./TableMetadata\";\nimport {ColumnMetadata} from \"./ColumnMetadata\";\nimport {EmbeddedMetadataArgs} from \"../metadata-args/EmbeddedMetadataArgs\";\n\n/**\n * Contains all information about entity's embedded property.\n */\nexport class EmbeddedMetadata {\n\n    // ---------------------------------------------------------------------\n    // Public Properties\n    // ---------------------------------------------------------------------\n\n    /**\n     * Its own entity metadata.\n     */\n    entityMetadata: EntityMetadata;\n\n    /**\n     * Parent embedded in the case if this embedded inside other embedded.\n     */\n    parentEmbeddedMetadata: EmbeddedMetadata;\n\n    // ---------------------------------------------------------------------\n    // Private Properties\n    // ---------------------------------------------------------------------\n\n    /**\n     * Property name on which this embedded is attached.\n     */\n    readonly propertyName: string;\n\n    /**\n     * Embeddable table.\n     */\n    readonly table: TableMetadata;\n\n    /**\n     * Embeddable table's columns.\n     */\n    readonly columns: ColumnMetadata[];\n\n    /**\n     * Nested embeddable in this embeddable.\n     */\n    readonly embeddeds: EmbeddedMetadata[];\n\n    /**\n     * Embedded type.\n     */\n    readonly type?: Function;\n\n    /**\n     * Indicates if this embedded is in array mode.\n     */\n    readonly isArray: boolean;\n\n    /**\n     * Prefix of the embedded, used instead of propertyName.\n     * If set to empty string, then prefix is not set at all.\n     */\n    readonly customPrefix: string|undefined;\n\n    // ---------------------------------------------------------------------\n    // Constructor\n    // ---------------------------------------------------------------------\n\n    constructor(table: TableMetadata,\n                columns: ColumnMetadata[],\n                embeddeds: EmbeddedMetadata[],\n                args: EmbeddedMetadataArgs) {\n        this.type = args.type ? args.type() : undefined;\n        this.propertyName = args.propertyName;\n        this.isArray = args.isArray;\n        this.customPrefix = args.prefix;\n        this.table = table;\n        this.columns = columns;\n        this.embeddeds = embeddeds;\n        this.embeddeds.forEach(embedded => {\n            embedded.parentEmbeddedMetadata = this;\n        });\n        this.columns.forEach(column => {\n            column.embeddedMetadata = this;\n        });\n    }\n\n    // ---------------------------------------------------------------------\n    // Public Methods\n    // ---------------------------------------------------------------------\n\n    /**\n     * Creates a new embedded object.\n     */\n    create() {\n        if (!this.type)\n            throw new Error(`Embedded cannot be created because it does not have a type set.`);\n\n        return new (this.type as any);\n    }\n\n    /**\n     * Gets the prefix of the columns.\n     * By default its a property name of the class where this prefix is.\n     * But if custom prefix is set then it takes its value as a prefix.\n     * However if custom prefix is set to empty string prefix to column is not applied at all.\n     */\n    get prefix() {\n        if (this.customPrefix !== undefined)\n            return this.customPrefix;\n\n        return this.propertyName;\n    }\n\n}"],"sourceRoot":".."}